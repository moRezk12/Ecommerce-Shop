import './polyfills.server.mjs';
import{a as D,b as M,c as j}from"./chunk-HTZD5BZ4.mjs";import{a as k}from"./chunk-HHN4LE3M.mjs";import{e as A}from"./chunk-7MVJ2AIR.mjs";import"./chunk-LONVUEKV.mjs";import"./chunk-QIQ6ZORK.mjs";import"./chunk-KU3OWX5F.mjs";import"./chunk-XKXUENXH.mjs";import{a as U}from"./chunk-KFJRXRTM.mjs";import{b as E,c as d,e as T,f as R,g as G,h,j as I,k as N,l as q,o as P}from"./chunk-LZY2TEO4.mjs";import{a as L}from"./chunk-6BD4JUNB.mjs";import{a as x}from"./chunk-4FXFYVUP.mjs";import"./chunk-ZY6AP4W3.mjs";import"./chunk-JFZEDU5W.mjs";import"./chunk-F5RLKEXU.mjs";import{k as F}from"./chunk-IW7GKRYI.mjs";import"./chunk-ECRDYV35.mjs";import"./chunk-MFG7RTPI.mjs";import{Gb as b,Nb as w,Oa as l,Ob as c,Pa as v,Pb as u,_ as y,db as f,hb as m,mb as a,qb as p,rb as o,sb as t,xb as S,yb as g}from"./chunk-4UJYGIJ6.mjs";import"./chunk-VVCT4QZE.mjs";var B=()=>({severity:"error",summary:"validation error",detail:"name is required"}),_=e=>[e],V=()=>({severity:"error",summary:"validation error",detail:"must be at least 3 char"}),z=()=>({severity:"error",summary:"validation error",detail:"cannot exceed 20 char"}),O=()=>({severity:"error",summary:"validation error",detail:"email is required"}),H=()=>({severity:"error",summary:"validation error",detail:"email not valid"}),J=()=>({severity:"error",summary:"validation error",detail:"password is required"}),K=()=>({severity:"error",summary:"validation error",detail:"rePassword not match password"});function Q(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,B)))("enableService",!1)("closable",!1)}function W(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,V)))("enableService",!1)("closable",!1)}function X(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,z)))("enableService",!1)("closable",!1)}function Y(e,s){if(e&1&&f(0,Q,1,6,"p-messages",14)(1,W,1,6,"p-messages",14)(2,X,1,6,"p-messages",14),e&2){let i=g();a(0,i.name.getError("required")?0:-1),l(),a(1,i.name.getError("minlength")?1:-1),l(),a(2,i.name.getError("maxlength")?2:-1)}}function Z(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,O)))("enableService",!1)("closable",!1)}function $(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,H)))("enableService",!1)("closable",!1)}function ee(e,s){if(e&1&&f(0,Z,1,6,"p-messages",14)(1,$,1,6,"p-messages",14),e&2){let i=g();a(0,i.email.getError("required")?0:-1),l(),a(1,i.email.getError("email")?1:-1)}}function ie(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,J)))("enableService",!1)("closable",!1)}function te(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,V)))("enableService",!1)("closable",!1)}function ne(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,z)))("enableService",!1)("closable",!1)}function oe(e,s){if(e&1&&f(0,ie,1,6,"p-messages",14)(1,te,1,6,"p-messages",14)(2,ne,1,6,"p-messages",14),e&2){let i=g();a(0,i.password.getError("required")?0:-1),l(),a(1,i.password.getError("minlength")?1:-1),l(),a(2,i.password.getError("maxlength")?2:-1)}}function re(e,s){e&1&&t(0,"p-messages",14),e&2&&m("value",u(4,_,c(3,K)))("enableService",!1)("closable",!1)}function ae(e,s){if(e&1&&f(0,re,1,6,"p-messages",14),e&2){let i=g();a(0,i.rePassword.getError("passNotMatch")?0:-1)}}var Se=(()=>{class e{constructor(i,n,r,C){this._authService=i,this._notifecationsService=n,this._router=r,this._userData=C,this.isRegisterd=!1,this.initFormControls(),this.initFormGroupe()}initFormControls(){this.name=new h("",[d.required,d.minLength(3),d.maxLength(20)]),this.email=new h("",[d.required,d.email]),this.password=new h("",[d.required,d.minLength(3),d.maxLength(20)]),this.rePassword=new h("",[d.required,this.passwordMatch(this.password)])}initFormGroupe(){this.registrationForm=new G({name:this.name,email:this.email,password:this.password,rePassword:this.rePassword})}passwordMatch(i){return n=>i.value!==n.value||n.value===""?{passNotMatch:!0}:null}submit(){this.registrationForm.valid?(this.siginUp(this.registrationForm.value),this.isRegisterd=!0):(this.registrationForm.markAllAsTouched(),Object.keys(this.registrationForm.controls).forEach(i=>this.registrationForm.controls[i].markAsDirty()))}siginUp(i){this._authService.register(i).subscribe({next:n=>{if(n._id){this._notifecationsService.showSuccess("success","success register");let{email:r,password:C}=i;this._authService.login({email:r,password:C}).subscribe(se=>{localStorage.setItem("token",n._id),this._router.navigate(["home"]),this._userData.userName.next(n.name),localStorage.setItem("username",n.name)})}},error:n=>{this._notifecationsService.showError("Error",n.error.error)}})}static{this.\u0275fac=function(n){return new(n||e)(v(x),v(L),v(F),v(U))}}static{this.\u0275cmp=y({type:e,selectors:[["app-register"]],standalone:!0,features:[w],decls:34,vars:6,consts:[[1,"container","my-8"],[1,"my-3","font-bold","capitalize"],[3,"ngSubmit","formGroup"],[1,"field"],[1,"pi","pi-user"],["pInputText","","formControlName","name","placeholder","Username",3,"autofocus"],[1,"validation-smg"],[1,"pi","pi-envelope"],["pInputText","","formControlName","email","placeholder","email"],[1,"validation-msg"],[1,"pi","pi-lock"],["pInputText","","type","password","formControlName","password","placeholder","password"],["pInputText","","formControlName","rePassword","placeholder","rePassword","type","password"],["type","submit","label","Submit"],[3,"value","enableService","closable"]],template:function(n,r){n&1&&(p(0,"section")(1,"div",0)(2,"h1",1),b(3,"register form"),o(),p(4,"form",2),S("ngSubmit",function(){return r.submit()}),p(5,"div",3)(6,"p-inputGroup")(7,"p-inputGroupAddon"),t(8,"i",4),o(),t(9,"input",5),o(),p(10,"div",6),f(11,Y,3,3),o()(),p(12,"div",3)(13,"p-inputGroup")(14,"p-inputGroupAddon"),t(15,"i",7),o(),t(16,"input",8),o(),p(17,"div",9),f(18,ee,2,2),o()(),p(19,"div",3)(20,"p-inputGroup")(21,"p-inputGroupAddon"),t(22,"i",10),o(),t(23,"input",11),o(),p(24,"div",9),f(25,oe,3,3),o()(),p(26,"div",3)(27,"p-inputGroup")(28,"p-inputGroupAddon"),t(29,"i",10),o(),t(30,"input",12),o(),p(31,"div",9),f(32,ae,1,1),o()(),t(33,"p-button",13),o()()()),n&2&&(l(4),m("formGroup",r.registrationForm),l(5),m("autofocus",!0),l(2),a(11,r.name.dirty&&r.name.touched?11:-1),l(7),a(18,r.email.touched&&r.email.dirty?18:-1),l(7),a(25,r.password.dirty&&r.password.touched?25:-1),l(7),a(32,r.rePassword.dirty&&r.rePassword.touched?32:-1))},dependencies:[j,I,E,T,R,N,q,D,M,P,A,k],styles:[`.p-element.p-button{display:block;width:100%}
`],encapsulation:2})}}return e})();export{Se as RegisterComponent};
